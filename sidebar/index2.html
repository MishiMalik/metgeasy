<!doctype html>
<html lang="en">

<head>
    <title>Title</title>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <!-- Bootstrap CSS v5.2.1 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" />
    <link rel="stylesheet" href="style.css">
    <style>
        .position-relative {
            position: relative;
        }

        #dropdown {
            position: absolute;
            top: 80px;
            /* Adjust to fit the location below the textarea */
            left: 0;
            /* Align dropdown with the textarea */
            z-index: 1000;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 4px;
            max-height: 150px;
            overflow-y: auto;
            width: 100%;
            padding: 5px;
        }

        #dropdown .dropdown-item {
            padding: 10px;
            cursor: pointer;
        }

        #dropdown .dropdown-item:hover {
            background-color: #f0f0f0;
        }
    </style>
    <style>
        .sidebar {
            width: 300px;
        }

        .condition-header {
            font-size: 16px;
            font-weight: 500;
            color: black;
            background-color: #f6f9fc !important;
            border-radius: 0px !important;
            box-shadow: none !important;
            padding: 8px 10px !important;
        }

        .condition-body {
            padding: 10px !important;
        }

        .run-condition h5 {
            font-size: 14px;
            font-weight: 500;
            margin: 0px !important;
            padding: 0px !important;
        }

        .add-condition p,
        .run-condition p {
            font-size: 14px;
            font-weight: 400;
            margin: 0px !important;
            padding: 0px !important;
            color: gray;
        }
    </style>
</head>

<body>
    <main>
        <div class="container">
            <div class="row">
                <div class="col-lg-10 mx-auto sidebar">
                    <div class="accordion" id="accordionExample-111">
                        <div class="accordion-item rounded-0 border-0">
                            <h2 class="accordion-header " id="heading111">
                                <button class="accordion-button condition-header border-0" type="button"
                                    data-bs-toggle="collapse" data-bs-target="#collapse111" aria-expanded="true"
                                    aria-controls="collapse111">
                                    Run Settings
                                </button>
                            </h2>
                            <div id="collapse111" class="accordion-collapse collapse show" aria-labelledby="heading111"
                                data-bs-parent="#accordionExample-111">
                                <div class="accordion-body condition-body">
                                    <div class="card run-condition border-0">
                                        <div class="d-flex justify-content-between align-items-center ">
                                            <div>
                                                <h5>Run Conditions</h5>
                                            </div>
                                            <div class="form-check form-switch">
                                                <input class="form-check-input" type="checkbox"
                                                    id="flexSwitchCheckDefault" />
                                            </div>

                                        </div>
                                        <div>

                                            <p class="mb-0 pb-0">Only Run this step if run conditions are met</p>
                                        </div>
                                        <!-- <div class="condition-on d-none p-3">
                                            <p class="mb-0 pb-0 condition-text-1">
                                                NO Run Conditions are Added
                                            </p>
                                            <p class="mb-0 pb-0 condition-text-2 d-none"></p>
                                            <br>
                                            <button class="btn btn-primary edit-condition-btn">Edit Condition</button>
                                        </div> -->
                                    </div>

                                    <!-- Add Condition Card -->
                                    <div class="card add-condition d-none mt-2">
                                        <p class="mb-0 pb-0 no-condition-added">
                                            NO Run Conditions are Added
                                        </p>
                                        <!-- Condition 1 -->
                                        <div class="condition-1 d-none mb-3">
                                            <div class="d-flex align-items-center gap-2">
                                                <p class="mb-0">Run If</p>
                                                <div class="flex-grow-1">
                                                    <select class="form-select form-select-lg condition-1-field">
                                                        <option value="Company" selected>Company</option>
                                                        <option value="Website URL">Website URL</option>
                                                        <option value="Similar Companies">Similar Companies</option>
                                                        <option value="Column D">Column D</option>
                                                        <option value="Column A">Column A</option>
                                                    </select>
                                                </div>
                                                <div class="flex-grow-1">
                                                    <select class="form-select form-select-lg condition-1-operator">
                                                        <option value="Contains" selected>Contains</option>
                                                        <option value="Does Not Contain">Does Not Contain</option>
                                                        <option value="Is">Is</option>
                                                        <option value="Is not">Is not</option>
                                                        <option value="is empty">is empty</option>
                                                        <option value="is not empty">is not empty</option>
                                                    </select>
                                                </div>
                                                <div class="flex-grow-1">
                                                    <input type="text" class="form-control condition-1-value"
                                                        placeholder="Enter value" />
                                                </div>
                                                <div class="">
                                                    <button class="delete-condition">delete</button>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Condition 2 -->
                                        <div class="condition-2 d-none mb-3">
                                            <div class="d-flex align-items-center gap-2">
                                                <div class="flex-grow-1">
                                                    <select class="form-select form-select-lg condition-2-logic">
                                                        <option selected>And</option>
                                                        <option value="Or">Or</option>
                                                    </select>
                                                </div>
                                                <div class="flex-grow-1">
                                                    <select class="form-select form-select-lg condition-2-field">
                                                        <option value="company" selected>Company</option>
                                                        <option value="Website URL">Website URL</option>
                                                        <option value="Similar Companies">Similar Companies</option>
                                                        <option value="Column D">Column D</option>
                                                        <option value="Column A">Column A</option>
                                                    </select>
                                                </div>
                                                <div class="flex-grow-1">
                                                    <select class="form-select form-select-lg condition-2-operator">
                                                        <option value="Contains" selected>Contains</option>
                                                        <option value="Does Not Contain">Does Not Contain</option>
                                                        <option value="Is">Is</option>
                                                        <option value="Is not">Is not</option>
                                                        <option value="is empty">is empty</option>
                                                        <option value="is not empty">is not empty</option>
                                                    </select>
                                                </div>
                                                <div class="flex-grow-1">
                                                    <input type="text" class="form-control condition-2-value"
                                                        placeholder="Enter value" />
                                                </div>
                                                <div class="">
                                                    <button class="delete-condition">delete</button>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Buttons -->
                                        <button class="btn btn-success add-condition-btn mb-2">Add Condition</button>
                                        <hr>
                                        <button class="btn btn-danger remove-all-btn">Remove All</button>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>

                </div>

                <div class="col-lg-10 mx-auto">
                    <div class="position-relative">
                        <textarea id="write-prompt" class="w-100 searchbar " placeholder="Write Prompt"></textarea>
                        <p class="text mb-0">Press # to select a variable cell</p>

                        <!-- Dropdown with options -->
                        <ul id="dropdown" class="dropdown-menu" style="display: none;">
                            <li><a class="dropdown-item" href="#">Option 1</a></li>
                            <li><a class="dropdown-item" href="#">Option 2</a></li>
                            <li><a class="dropdown-item" href="#">Option 3</a></li>
                        </ul>
                    </div>

                </div>
            </div>
        </div>



    </main>
    <!-- Bootstrap JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
        integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
        crossorigin="anonymous"></script>

    <script src="https://code.jquery.com/jquery-3.7.1.slim.js"
        integrity="sha256-UgvvN8vBkgO0luPSUl2s8TIlOSYRoGFAX4jlCIm9Adc=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
     <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init();
      </script>
    <!-- jQuery Script -->
    <script>
        $(document).ready(function () {
            let clickCount = 0;
            // Toggle .add-condition based on the specific switch for all instances
            $(document).on('change', '.form-check-input', function () {
                // Find the closest accordion body where the switch is located
                const $accordionBody = $(this).closest('.accordion-body');
                const $addConditionCard = $accordionBody.find('.add-condition');

                // Toggle the visibility of the add-condition card
                $addConditionCard.toggleClass('d-none', !$(this).is(':checked'));
            });

            // // Toggle .condition-on based on the switch
            // $('#flexSwitchCheckDefault').on('change', function () {
            //     $('.add-condition').toggleClass('d-none', !$(this).is(':checked'));
            // });
            $(document).ready(function () {

                // On Add Condition button click (works for all instances of add-condition-btn)
                $(document).on('click', '.add-condition-btn', function () {
                    const $accordionBody = $(this).closest('.accordion-body');
                    const $condition1 = $accordionBody.find('.condition-1');
                    const $noConditionText = $accordionBody.find('.no-condition-added');
                    const $condition2Template = $accordionBody.find('.condition-2:first');
                    const $removeAllBtn = $accordionBody.find('.remove-all-btn');

                    // Show Remove All button when condition-1 is added
                    if ($removeAllBtn.hasClass('d-none')) {
                        $removeAllBtn.removeClass('d-none');
                    }

                    // Check if condition-1 is shown, if not, show it
                    if ($condition1.hasClass('d-none')) {
                        $condition1.removeClass('d-none');
                        $noConditionText.addClass('d-none'); // Hide the "NO Run Conditions are Added" text
                    }
                    // If condition-1 is already shown, add new condition-2 every time
                    else {
                        // Clone the condition-2 and append it after the last condition-2
                        let newCondition = $condition2Template.clone();
                        newCondition.find('input').val(''); // Clear input fields
                        newCondition.removeClass('d-none');
                        $accordionBody.find('.condition-2:last').after(newCondition);
                    }
                });

                // On Remove All button click (works for all instances of remove-all-btn)
                $(document).on('click', '.remove-all-btn', function () {
                    const $accordionBody = $(this).closest('.accordion-body');
                    const $condition1 = $accordionBody.find('.condition-1');
                    const $condition2 = $accordionBody.find('.condition-2');
                    const $noConditionText = $accordionBody.find('.no-condition-added');
                    const $removeAllBtn = $accordionBody.find('.remove-all-btn');

                    // Reset all conditions and show "NO Run Conditions are Added" text
                    $condition1.addClass('d-none');
                    $condition2.addClass('d-none').not(':first').remove(); // Remove all cloned condition-2 elements
                    $noConditionText.removeClass('d-none');

                    // Hide the Remove All button after conditions are removed
                    $removeAllBtn.addClass('d-none');
                });

                // Delete individual condition (works for all instances of delete-condition)
                $(document).on('click', '.delete-condition', function () {
                    const $accordionBody = $(this).closest('.accordion-body');
                    $(this).closest('.d-flex').parent().remove(); // Remove the specific condition block

                    const $condition1 = $accordionBody.find('.condition-1');
                    const $conditions = $accordionBody.find('.condition-2:not(.d-none)');
                    const $noConditionText = $accordionBody.find('.no-condition-added');
                    const $removeAllBtn = $accordionBody.find('.remove-all-btn');

                    // If there are no more conditions, hide Remove All button and show the "NO Run Conditions are Added" text
                    if ($condition1.hasClass('d-none') && $conditions.length === 0) {
                        $noConditionText.removeClass('d-none');
                        $removeAllBtn.addClass('d-none');
                    }
                });
            });


        });

    </script>

    <script>
        document.getElementById('write-prompt').addEventListener('input', function (e) {
            const textarea = e.target;
            const value = textarea.value;
            const cursorPosition = textarea.selectionStart;
            const dropdown = document.getElementById('dropdown');

            // Check if '#' was just typed
            if (value.charAt(cursorPosition - 1) === '#') {
                // Show the dropdown
                dropdown.style.display = 'block';
            } else {
                dropdown.style.display = 'none';
            }
        });

        // Add click event listener for all dropdown items
        document.querySelectorAll('#dropdown .dropdown-item').forEach(item => {
            item.addEventListener('click', function (e) {
                const textarea = document.getElementById('write-prompt');
                const cursorPosition = textarea.selectionStart;
                const textBefore = textarea.value.substring(0, cursorPosition);
                const textAfter = textarea.value.substring(cursorPosition);
                const selectedText = e.target.textContent;
                const dropdown = document.getElementById('dropdown');

                // Insert selected dropdown item where the cursor is
                textarea.value = textBefore + selectedText + textAfter;

                // Update cursor position to after the inserted text
                textarea.selectionStart = textarea.selectionEnd = textBefore.length + selectedText.length;

                // Hide the dropdown after selection
                dropdown.style.display = 'none';

                // Focus back on the textarea
                textarea.focus();
            });
        });

        // Optionally, add functionality to close dropdown when clicking outside or pressing 'Escape'
        document.addEventListener('click', function (e) {
            const dropdown = document.getElementById('dropdown');
            if (!e.target.closest('#dropdown') && !e.target.closest('#write-prompt')) {
                dropdown.style.display = 'none';
            }
        });

        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') {
                document.getElementById('dropdown').style.display = 'none';
            }
        });


    </script>





</body>

</html>